#!/bin/bash
BASE=`pwd`

# Add PPA which offers latest vim ---------------------------------------------
if (( ! $(apt-cache policy | grep -i 'vim' | wc -l) )); then
	sudo add-apt-repository ppa:jonathonf/vim
	sudo apt-get update
	sudo apt-get install vim
fi

# Install Plugin Manager ------------------------------------------------------
if [ ! -e ~/.vim/bundle/Vundle.vim ]; then
	echo "Vundle is not found. cloning..."
	git clone https://github.com/gmarik/Vundle.vim.git ~/.vim/bundle/Vundle.vim
fi

# Install Plugins -------------------------------------------------------------
cp vimrc ~/.vimrc
vim +PluginInstall +qall

# Install Plugins :: CommandT
if [ ! -e ~/.vim/bundle/command-t/ruby/command-t/ext.so ]; then
	sudo apt-get install ack-grep vim-gnome vim-nox vim-rails ruby-dev -y
	cd ~/.vim/bundle/command-t/ruby/command-t
	ruby extconf.rb
	make
	cd $BASE
fi

# Install Plugins :: YouCompleteMe
if [ ! -e ~/.vim/bundle/YouCompleteMe/third_party/ycmd/ycm_core.so ]; then
	sudo apt-get install build-essential cmake clang python-dev python3-dev ack-grep -y
	cd ~/.vim/bundle/YouCompleteMe
	./install.py --clang-completer
	cd ~/.vim
	curl -O -L https://raw.githubusercontent.com/Valloric/ycmd/master/cpp/ycm/.ycm_extra_conf.py
	cd $BASE
fi

